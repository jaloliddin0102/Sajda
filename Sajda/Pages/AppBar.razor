@namespace Sajda.Pages
@using MudBlazor
@inject NavigationManager Navigation
@inject IDialogService DialogService
@using System.Globalization

<MudAppBar Color="Color.Primary" Fixed="true">
    <!-- Chap tomonda sana -->
    <MudText Typo="Typo.body1" Class="date-time-text">
        @CurrentDate
    </MudText>

    <MudSpacer />

    <!-- O'rtada hozirgi vaqt va Tashkent matni -->
    <MudText Typo="Typo.body1" Class="date-time-text">
        @CurrentTime Tashkent
    </MudText>

    <MudSpacer />

    <!-- O'ng tomonda Telegram ikonkasi -->
    <MudIconButton Icon="@Icons.Custom.Brands.Telegram" Color="Color.Dark" OnClick="@OpenTelegram" />
</MudAppBar>

@code {
    private string CurrentTime { get; set; } = DateTime.Now.ToString("HH:mm:ss", new CultureInfo("en-US"));
    private string CurrentDate { get; set; } = DateTime.Now.ToString("dddd, dd.MM.yyyy", new CultureInfo("en-US"));

    protected override void OnInitialized()
    {
        var timer = new System.Timers.Timer(1000); // 1 soniyalik timer
        timer.Elapsed += (sender, args) =>
        {
            CurrentTime = DateTime.Now.ToString("HH:mm:ss", new CultureInfo("en-US"));
            CurrentDate = DateTime.Now.ToString("dddd, dd.MM.yyyy", new CultureInfo("en-US"));
            InvokeAsync(StateHasChanged);
        };
        timer.Start();
    }

    private void OpenTelegram()
    {
        Navigation.NavigateTo("https://t.me/JM01020527", forceLoad: true);
    }
}
